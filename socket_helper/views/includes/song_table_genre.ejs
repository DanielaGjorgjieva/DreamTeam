<% function find_by(a, f) {
    var keys = Object.keys(f).filter((k)=> f[k] !== undefined && f[k] !== null);
    return a.filter((x)=>{ return keys.every((a)=>{ return f[a] === x[a] }) })
}
    let song_array = find_by(result, {"genre": ge});
    
%>


<main class="song_table">
<header class="songs-header">
    <span></span>
    <a href="songs.html?sort=filename">Filename</a>
    <a href="songs.html?sort=duration">Duration (MM:SS)</a>
    <a href="songs.html?sort=size">Size (MB)</a>
    <a href="songs.html?sort=title">Title</a>
    <a href="songs.html?sort=album">Album</a>
    <a href="songs.html?sort=artist">Artist</a>
    <a href="songs.html?sort=genre">Genre</a>
    <a href="songs.html?sort=desc">Description</a>
    <a href="songs.html?sort=quality">Quality</a>
    <a href="songs.html?sort=favourite">Fav</a>
</header>

<% function add_song() {

let add = ``;
song_array.forEach((song) => {
add += `<article class="song" id="${song._id}">
<a rel="play" href="player.html?61460e91efd0d795bff2e3d5" target="player">Play</a>
<span class="filename">${song.filename}</span>
<span class="duration">${song.duration}</span>
<span class="size">${song.size}</span>
<span class="title">${song.title}</span>
<span class="album">${song.album}</span>
<span class="artist">${song.artist}</span>
<span class="genre">${song.genre}</span>
<span class="desc"></span>
<span><progress class="quality" min="0" max="10" value="3"></progress></span>
<button data-action="fav" id="fav_61460e91efd0d795bff2e3d5" data-fav="true">&#9733;</button>
<button class="delete-button" data-action="delete" id="delete_61460e91efd0d795bff2e3d5">&#215;</button>
<a class="edit-button" rel="edit" href="/songs/${song._id}/edit" >EDIT</a>
</article>`
})

return add;

} %>
<%- add_song() %>
</main>